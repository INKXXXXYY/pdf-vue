# 更新日志

## [1.1.0] - 2024-12-28

### 🎯 重要修复
- **原文替换功能优化**
  - 修复双击编辑时立即失去焦点的问题
  - 编辑框尺寸现在与原红框尺寸一致
  - 改进用户交互检测，防止意外提交
  - 编辑完成后保持其他文本的红框显示

- **下划线功能修复**
  - 解决编辑其他元素（椭圆/直线等）后无法选中文本的问题
  - 修复工具模式切换时文本层属性被意外修改的问题
  - 增强下划线模式的状态保护和恢复机制

- **图片导出修复**
  - 修复添加图片后导出PDF看不到图片的问题
  - 将图片存储格式从Object URL改为base64 data URL
  - 确保前端和服务端导出的兼容性
  - 添加详细的图片处理调试日志

### 🔧 技术改进
- 增强工具模式切换的稳定性
- 改进文本层重建后的样式重新应用机制
- 优化编辑器焦点管理和事件处理
- 添加全面的调试日志系统

### ⚠️ 已知限制
- **文本span偏移问题**：在使用原文替换、下划线、文本选择等功能时，可能出现span元素位置偏移的情况。这与PDF文本层的复杂布局和坐标转换有关，目前暂时没有找到完美的解决方法。

### 🧪 测试状态
- ✅ 原文替换功能完全测试
- ✅ 下划线功能完全测试  
- ✅ 图片添加和导出功能完全测试
- ✅ 工具模式切换稳定性测试
- ✅ 前端和服务端导出功能测试

### 📋 版本标记
- 稳定标签: `stable-v1.1.0`
- 建议在生产环境中使用此版本

---

## [1.0.x] - 历史版本
- 基础PDF查看和注释功能
- 页面重排功能
- 服务端导出功能
- 中文字体支持

详细的历史更新请参考README.md中的版本快照部分。
